<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.diet_comment.mapper.PostMapper">

    <!-- 定义一个可复用的ResultMap来处理关联关系 -->
    <resultMap id="PostWithUserAndShopMap" type="com.example.diet_comment.model.Post">
        <!-- Post 自身字段 -->
        <id property="id" column="post_id"/>
        <result property="title" column="post_title"/>
        <result property="content" column="post_content"/>
        <result property="userId" column="post_user_id"/>
        <result property="shopId" column="post_shop_id"/>
        <result property="createdAt" column="post_created_at"/>
        <result property="updatedAt" column="post_updated_at"/>

        <!-- 关联User对象 -->
        <association property="user" javaType="com.example.diet_comment.model.DTO.UserDTO">
            <id property="id" column="user_id"/>
            <result property="userName" column="user_name"/>
            <result property="email" column="user_email"/>
            <result property="avatarUrl" column="user_avatar_url"/>
        </association>

        <!-- 关联Shop对象 -->
        <association property="shop" javaType="com.example.diet_comment.model.Shop">
            <id property="id" column="shop_id"/>
            <result property="name" column="shop_name"/>
            <result property="address" column="shop_address"/>
            <result property="rating" column="shop_rating"/>
            <result property="reviews" column="shop_reviews"/>
            <result property="price" column="shop_price"/>
            <result property="imgurl" column="shop_imgurl"/>
            <result property="tags" column="shop_tags"/>
            <result property="createdAt" column="shop_created_at"/>
            <result property="updatedAt" column="shop_updated_at"/>
        </association>
    </resultMap>

</mapper>
